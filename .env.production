# Dyocense Production Environment Configuration
# Copy this file to .env and customize for your production deployment

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================

ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# =============================================================================
# FEATURE FLAGS - Enable real implementations for production
# =============================================================================

# DO NOT force in-memory mode in production
FORCE_INMEMORY_MODE=false

# Enable all production services
USE_MONGODB=true
USE_KEYCLOAK=true
USE_NEO4J=true
USE_QDRANT=true
USE_LLM=true

# Strict mode - fail if dependencies unavailable (REQUIRED for production)
STRICT_MODE=true

# Optional features
ENABLE_TRANSACTIONS=true
ENABLE_CACHING=true
ENABLE_METRICS=true

# =============================================================================
# MONGODB (REQUIRED)
# =============================================================================

# Production MongoDB Atlas (Recommended)
MONGO_URI=mongodb+srv://<username>:<password>@<cluster>.mongodb.net/?retryWrites=true&w=majority
MONGO_DB_NAME=dyocense

# OR Self-Hosted MongoDB with Replica Set
# MONGO_HOST=mongodb-primary.internal
# MONGO_PORT=27017
# MONGO_USERNAME=dyocense_app
# MONGO_PASSWORD=<secure-password>
# MONGO_AUTH_DB=admin
# MONGO_DB_NAME=dyocense
# MONGO_REPLICA_SET=rs0

# TLS/SSL Configuration (Recommended for production)
# MONGO_TLS=true
# MONGO_TLS_CA_FILE=/path/to/ca-cert.pem

# Connection Pool Tuning
MONGO_MAX_POOL_SIZE=100
MONGO_MIN_POOL_SIZE=20

# =============================================================================
# KEYCLOAK AUTHENTICATION (REQUIRED)
# =============================================================================

# Keycloak server URL (without /auth if using Keycloak 17+)
KEYCLOAK_SERVER_URL=https://auth.yourdomain.com
KEYCLOAK_REALM=dyocense
KEYCLOAK_CLIENT_ID=dyocense-api
KEYCLOAK_CLIENT_SECRET=<your-client-secret>

# Admin credentials for user/realm management
KEYCLOAK_ADMIN_USERNAME=admin
KEYCLOAK_ADMIN_PASSWORD=<secure-admin-password>

# =============================================================================
# LLM SERVICES (REQUIRED for intelligent compilation)
# =============================================================================

# Option 1: Azure OpenAI (Recommended for enterprise)
LLM_PROVIDER=azure
AZURE_OPENAI_ENDPOINT=https://<your-resource>.openai.azure.com
AZURE_OPENAI_API_KEY=<your-api-key>
AZURE_OPENAI_DEPLOYMENT=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-15-preview

# Option 2: OpenAI API
# LLM_PROVIDER=openai
# OPENAI_API_KEY=sk-proj-...
# OPENAI_MODEL=gpt-4
# OPENAI_ORGANIZATION=org-...

# LLM Configuration
LLM_TEMPERATURE=0.7
LLM_MAX_TOKENS=4000
LLM_TIMEOUT=60

# =============================================================================
# NEO4J GRAPH DATABASE (Recommended for evidence lineage)
# =============================================================================

# Neo4j AuraDB (Recommended)
NEO4J_URI=neo4j+s://<instance-id>.databases.neo4j.io
NEO4J_USERNAME=neo4j
NEO4J_PASSWORD=<secure-password>
NEO4J_DATABASE=neo4j

# Self-Hosted Neo4j
# NEO4J_URI=bolt://neo4j.internal:7687
# NEO4J_USERNAME=neo4j
# NEO4J_PASSWORD=<secure-password>

# Connection Tuning
NEO4J_MAX_CONNECTION_LIFETIME=3600
NEO4J_MAX_POOL_SIZE=50

# =============================================================================
# QDRANT VECTOR DATABASE (Recommended for semantic search)
# =============================================================================

# Qdrant Cloud (Recommended)
QDRANT_URL=https://<cluster-id>.aws.cloud.qdrant.io
QDRANT_API_KEY=<your-api-key>
QDRANT_COLLECTION=dyocense_knowledge

# Self-Hosted Qdrant
# QDRANT_URL=https://qdrant.internal:6333
# QDRANT_API_KEY=<your-api-key>
# QDRANT_COLLECTION=dyocense_knowledge

# Vector Configuration
QDRANT_VECTOR_SIZE=1536
QDRANT_DISTANCE=cosine

# =============================================================================
# SECURITY SETTINGS (REQUIRED for production)
# =============================================================================

# DO NOT allow anonymous access in production
ALLOW_ANONYMOUS=false

# CORS Configuration (adjust for your frontend domain)
# CORS_ORIGINS=https://app.yourdomain.com,https://www.yourdomain.com

# API Rate Limiting (requests per minute per tenant)
# RATE_LIMIT_PER_MINUTE=1000

# =============================================================================
# MONITORING & OBSERVABILITY
# =============================================================================

# Application Insights / OpenTelemetry
# APPLICATIONINSIGHTS_CONNECTION_STRING=InstrumentationKey=...

# Prometheus Metrics Endpoint
# ENABLE_PROMETHEUS=true
# PROMETHEUS_PORT=9090

# Sentry Error Tracking
# SENTRY_DSN=https://...@sentry.io/...
# SENTRY_ENVIRONMENT=production

# =============================================================================
# BACKUP & DISASTER RECOVERY
# =============================================================================

# MongoDB Backup Schedule (managed by MongoDB Atlas or external tool)
# BACKUP_ENABLED=true
# BACKUP_RETENTION_DAYS=30

# =============================================================================
# PRODUCTION CHECKLIST
# =============================================================================
#
# Before deploying to production, verify:
#
# [ ] All <placeholders> replaced with real values
# [ ] MongoDB connection tested and indexed
# [ ] Keycloak realm configured with production users
# [ ] LLM API keys valid with sufficient quota
# [ ] Neo4j accessible and schema validated
# [ ] Qdrant collection created with correct dimensions
# [ ] STRICT_MODE=true
# [ ] FORCE_INMEMORY_MODE=false
# [ ] ALLOW_ANONYMOUS=false
# [ ] DEBUG=false
# [ ] Secrets stored in vault (not committed to git)
# [ ] TLS/HTTPS enabled on all services
# [ ] Health checks return "healthy" for all services
# [ ] Monitoring and alerting configured
# [ ] Backup strategy defined and tested
# [ ] Load testing performed
# [ ] Incident response plan documented
#
# Health Check Command:
# curl https://api.yourdomain.com/health/detailed
#
# Expected: All services show "status": "healthy" (not "degraded" or "in-memory")
